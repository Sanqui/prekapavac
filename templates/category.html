{% extends "_base.html" %}

{% block title %} {{ project.name }} » {{ category.name }} {% endblock %}

{% block content %}

    <ol class="breadcrumb">
        <li><a href="{{ url_for('index') }}">{{ g.sitename }}</a>
        <li><a href="{{ project.url }}">{{ project.name }}</a>
        <li class="active">{{ category.name }}
    </ol>
    <h2>{{ category.name }}</h2>
    
    <p> {{ category.description | markdown }}
    
    {% if current_user.is_authenticated %}
        {% set rated = category.count_suggestions(current_user) %}
        {% set total = category.count_suggestions() %}
        {% if total %}
            {% set percentage = round(rated / total * 100) %}
            <div class="rating-completion">
                Máš ohodnoceno: {{ rated }} / {{ total }}
                <div class="progress">
                    <div class="progress-bar" style="width: {{ percentage }}%;">
                        {{ percentage }}%
                    </div>
                </div>
                {% if percentage == 100 %}
                    Dobrá práce!
                {% endif %}
            </div>
        {% endif %}
    {% endif %}
        
    <table class="table table-bordered table-terms">
        <thead>
            <tr>
                <td>num</td>
                <td>en</td>
                <td>jp</td>
                <td>návrhy</td>
            </tr>
        <tbody>
            {% for term in terms %}
                    <tr class="tr-link" data-href="{{ term.url }}">
                        <td>
                            <a href="{{ term.url }}">#{{ term.number }}</a>
                        </td>
                        <td>
                            <a href="{{ term.url }}">{{ term.text_en }}</a>
                        </td>
                        <td>
                            <a href="{{ term.url }}">{{ term.text_jp }}</a></td>
                        <td class="td-suggestions">
                            {% if term.locked %}
                                <span class="glyphicon glyphicon-lock"></span>
                            {% else %}
                                <ul class="suggestions">
                                    {% for suggestion, score in term.suggestions_w_score %}
                                        <li>
                                            {{ unrated_icon(suggestion) }}
                                            {{ suggestion.text }}
                                    {% endfor %}
                                </li>
                            {% endif %}
                        </td>
                    </td>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}
